{"ast":null,"code":"import React, { useState, forwardRef, useImperativeHandle, useRef } from 'react';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { CloseCircleFill } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport classNames from 'classnames';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nimport { bound } from '../../utils/bound';\nconst classPrefix = `adm-input`;\nconst defaultProps = {\n  defaultValue: ''\n};\nexport const Input = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue(props);\n  const [hasFocus, setHasFocus] = useState(false);\n  const nativeInputRef = useRef(null);\n  useImperativeHandle(ref, () => ({\n    clear: () => {\n      setValue('');\n    },\n    focus: () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    },\n    blur: () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n    }\n  }));\n\n  const handleKeydown = e => {\n    var _a;\n\n    if (props.onEnterPress && (e.code === 'Enter' || e.keyCode === 13)) {\n      props.onEnterPress(e);\n    }\n\n    (_a = props.onKeyDown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    var _a;\n\n    if (!props.enterKeyHint) return;\n    (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('enterkeyhint', props.enterKeyHint);\n    return () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.removeAttribute('enterkeyhint');\n    };\n  }, [props.enterKeyHint]);\n\n  function checkValue() {\n    let nextValue = value;\n\n    if (props.type === 'number') {\n      nextValue = nextValue && bound(parseFloat(nextValue), props.min, props.max).toString();\n    }\n\n    if (nextValue !== value) {\n      setValue(nextValue);\n    }\n  }\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(`${classPrefix}`, props.disabled && `${classPrefix}-disabled`)\n  }, React.createElement(\"input\", {\n    ref: nativeInputRef,\n    className: `${classPrefix}-element`,\n    value: value,\n    onChange: e => {\n      setValue(e.target.value);\n    },\n    onFocus: e => {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onBlur: e => {\n      var _a;\n\n      setHasFocus(false);\n      checkValue();\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    id: props.id,\n    placeholder: props.placeholder,\n    disabled: props.disabled,\n    readOnly: props.readOnly,\n    maxLength: props.maxLength,\n    minLength: props.minLength,\n    max: props.max,\n    min: props.min,\n    autoComplete: props.autoComplete,\n    pattern: props.pattern,\n    inputMode: props.inputMode,\n    type: props.type,\n    autoCapitalize: props.autoCapitalize,\n    autoCorrect: props.autoCorrect,\n    onKeyDown: handleKeydown,\n    onKeyUp: props.onKeyUp,\n    onCompositionStart: props.onCompositionStart,\n    onCompositionEnd: props.onCompositionEnd\n  }), props.clearable && !!value && !props.readOnly && hasFocus && React.createElement(\"div\", {\n    className: `${classPrefix}-clear`,\n    onMouseDown: e => {\n      e.preventDefault();\n    },\n    onClick: () => {\n      var _a;\n\n      setValue('');\n      (_a = props.onClear) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseCircleFill, null))));\n});","map":{"version":3,"sources":["E:/wcy/Github/fun-rec/codes/news_recsys/news_rec_web/my-app-ts/node_modules/antd-mobile/es/components/input/input.js"],"names":["React","useState","forwardRef","useImperativeHandle","useRef","usePropsValue","CloseCircleFill","withNativeProps","mergeProps","classNames","useIsomorphicLayoutEffect","bound","classPrefix","defaultProps","defaultValue","Input","p","ref","props","value","setValue","hasFocus","setHasFocus","nativeInputRef","clear","focus","_a","current","blur","handleKeydown","e","onEnterPress","code","keyCode","onKeyDown","call","enterKeyHint","setAttribute","removeAttribute","checkValue","nextValue","type","parseFloat","min","max","toString","createElement","className","disabled","onChange","target","onFocus","onBlur","id","placeholder","readOnly","maxLength","minLength","autoComplete","pattern","inputMode","autoCapitalize","autoCorrect","onKeyUp","onCompositionStart","onCompositionEnd","clearable","onMouseDown","preventDefault","onClick","onClear"],"mappings":"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","sourcesContent":["import React, { useState, forwardRef, useImperativeHandle, useRef } from 'react';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { CloseCircleFill } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport classNames from 'classnames';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nimport { bound } from '../../utils/bound';\nconst classPrefix = `adm-input`;\nconst defaultProps = {\n  defaultValue: ''\n};\nexport const Input = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue(props);\n  const [hasFocus, setHasFocus] = useState(false);\n  const nativeInputRef = useRef(null);\n  useImperativeHandle(ref, () => ({\n    clear: () => {\n      setValue('');\n    },\n    focus: () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    },\n    blur: () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n    }\n  }));\n\n  const handleKeydown = e => {\n    var _a;\n\n    if (props.onEnterPress && (e.code === 'Enter' || e.keyCode === 13)) {\n      props.onEnterPress(e);\n    }\n\n    (_a = props.onKeyDown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    var _a;\n\n    if (!props.enterKeyHint) return;\n    (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('enterkeyhint', props.enterKeyHint);\n    return () => {\n      var _a;\n\n      (_a = nativeInputRef.current) === null || _a === void 0 ? void 0 : _a.removeAttribute('enterkeyhint');\n    };\n  }, [props.enterKeyHint]);\n\n  function checkValue() {\n    let nextValue = value;\n\n    if (props.type === 'number') {\n      nextValue = nextValue && bound(parseFloat(nextValue), props.min, props.max).toString();\n    }\n\n    if (nextValue !== value) {\n      setValue(nextValue);\n    }\n  }\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(`${classPrefix}`, props.disabled && `${classPrefix}-disabled`)\n  }, React.createElement(\"input\", {\n    ref: nativeInputRef,\n    className: `${classPrefix}-element`,\n    value: value,\n    onChange: e => {\n      setValue(e.target.value);\n    },\n    onFocus: e => {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onBlur: e => {\n      var _a;\n\n      setHasFocus(false);\n      checkValue();\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    id: props.id,\n    placeholder: props.placeholder,\n    disabled: props.disabled,\n    readOnly: props.readOnly,\n    maxLength: props.maxLength,\n    minLength: props.minLength,\n    max: props.max,\n    min: props.min,\n    autoComplete: props.autoComplete,\n    pattern: props.pattern,\n    inputMode: props.inputMode,\n    type: props.type,\n    autoCapitalize: props.autoCapitalize,\n    autoCorrect: props.autoCorrect,\n    onKeyDown: handleKeydown,\n    onKeyUp: props.onKeyUp,\n    onCompositionStart: props.onCompositionStart,\n    onCompositionEnd: props.onCompositionEnd\n  }), props.clearable && !!value && !props.readOnly && hasFocus && React.createElement(\"div\", {\n    className: `${classPrefix}-clear`,\n    onMouseDown: e => {\n      e.preventDefault();\n    },\n    onClick: () => {\n      var _a;\n\n      setValue('');\n      (_a = props.onClear) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseCircleFill, null))));\n});"]},"metadata":{},"sourceType":"module"}